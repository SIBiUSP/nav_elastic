store:
  oai:
    package: Elasticsearch
    options:
      index_name: sibi
      bags:
        publication:
          cql_mapping:
            default_index: basic
            indexes:
              _id:
                op:
                  'any': true
                  'all': true
                  '=': true
                  'exact': true
                field: '_id'
              basic:
                op:
                  'any': true
                  'all': true
                  '=': true
                  '<>': true
                field: '_all'
                description: "index with common fields..."
              datestamp:
                op:
                  '=': true
                  '<': true
                  '<=': true
                  '>=': true
                  '>': true
                  'exact': true
                field: 'datestamp'
      index_mappings:
        publication:
          properties:
            datestamp: {type: date, format: date_time_no_millis}

plugins:
  'Catmandu::OAI':
    store: oai
    bag: sibi
    datestamp_field: datestamp
    repositoryName: "Biblioteca Digital da Produção Intelectual"
    uri_base: "http://bdpife2.sibi.usp.br:3000/oai"
    adminEmail: tiago.murakami@dt.sibi.usp.br
    earliestDatestamp: "1970-01-01T00:00:01Z"
    deletedRecord: persistent
    repositoryIdentifier: oai.producao.usp.br
    cql_filter: "datestamp>2010-12-01T00:00:00Z"
    limit: 200
    delimiter: ":"
    sampleIdentifier: "oai:oai.producao.usp.br:001585315"
    metadata_formats:
      -
        metadataPrefix: oai_dc
        schema: "http://www.openarchives.org/OAI/2.0/oai_dc.xsd"
        metadataNamespace: "http://www.openarchives.org/OAI/2.0/oai_dc/"
        template: oai_dc.tt
        fix:
          - nothing()
    sets:
      -
        setSpec: openaccess
        setName: Open Access
        cql: 'oa=1'